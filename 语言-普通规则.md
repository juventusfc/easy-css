# 普通规则

普通规则由选择器和声明区块组成。常见的普通规则如下：

```css
h2 {
  color: blue;
}
```

## 选择器

```css
div#container p {
  font-weight: bold;
}
```

具体可参考如下图：
![css-selector](./images/css-selector.png)

关于 combinator 的对比，可以点击[这篇文章](https://techbrij.com/css-selector-adjacent-child-sibling)。

### 简单选择器

根据某一特征判断是否选择元素。

![simple-selector](./images/simple-selector.png)

#### 类型选择器

```css
div {
  font-size: 20px;
}
```

如果需要考虑 html 或者 xml 命名空间的问题，就复杂了。

比如 svg，它时定义在 [http://www.w3.org/2000/svg](http://www.w3.org/2000/svg) 命名空间下的。svg 里的 a 和 html 里的 a 需要使用带命名空间的类型选择器。

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>JS Bin</title>
    <style>
      @namespace svg url(http://www.w3.org/2000/svg);
      @namespace html url(http://www.w3.org/1999/xhtml);
      svg|a {
        stroke: blue;
        stroke-width: 1;
      }
      html|a {
        font-size: 40px;
      }
    </style>
  </head>
  <body>
    <svg
      width="100"
      height="28"
      viewBox="0 0 100 28"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
    >
      <desc>Example link01 - a link on an ellipse</desc>
      <a xlink:href="http://www.w3.org">
        <text y="100%">name</text>
      </a>
    </svg>
    <br />
    <a href="javascript:void 0;">name</a>
  </body>
</html>
```

#### 全体选择器

```css
* {
  font-size: 40px;
}
```

#### id 选择器和 class 选择器

针对特定属性的选择器。

```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>JS Bin</title>
    <style>
      #myid {
        font-size: 20px;
      }

      .mycls {
        font-size: 40px;
      }

      /* 最后一个 div 元素的 class 为a b c,使用 .a .b .c 都可以选中a标签 */
      .a {
        color: red;
      }
    </style>
  </head>
  <body>
    <div id="myid">id example</div>
    <div class="mycls">class example</div>
    <div class="a b c">xxx</div>
  </body>
</html>
```

#### 属性选择器

根据 HTML 元素的属性来选择元素。

- [att]  
  直接在方括号中放入属性名。只要元素有这个属性，就会被选中。

  ```css
  [frank] {
    color: red;
  }
  ```

  ```html
  <div frank="hu">test att</div>
  ```

- [att=val]  
  精确匹配。只有元素的属性值等于 val 才会被选中。

  ```css
  [frank="hu"] {
    color: red;
  }
  ```

  ```html
  <div frank="hu">div will be selected</div>
  <div frank="juven">div will NOT be selected</div>
  ```

- [att~=val]  
  多种匹配。只要元素的属性 attr 的值中有一个是 val ，该元素就会被选中。

  ```css
  [frank~="hu"] {
    color: red;
  }
  ```

  ```html
  <div frank="hu">div will be selected</div>
  <div frank="juven hu">div will be selected</div>
  ```

- [att|=val]  
   开头匹配，检查一个元素的值是否是以 val 开头，元素的属性值只要以 val 开头即可，然后以"-"分割，就会被选中。

  ```css
  [frank|="hu"] {
    color: red;
  }
  ```

  ```html
  <div frank="hu">div will be selected</div>
  <div frank="hu-juve">div will be selected</div>
  <div frank="hujuve">div will Not be selected</div>
  ```

#### 伪类选择器

伪类选择器相当于在其他选择器的基础上增加条件。

```css
selector:pseudo-class {
  property: value;
}
```

##### 树结构关系伪类选择器

- :root  
  选择 HTML 文件的 html 标签。经常用于设置 CSS 变量。

  ```css
  :root {
    background: yellow;
    --main-color: hotpink;
    --pane-padding: 5px 42px;
  }
  ```

- :empty  
  选择 div 元素，这些 div 元素是没有子元素的。

  ```css
  div:empty {
    background: lime;
  }
  ```

- :nth-child()以及:nth-last-child()  
  选择 li 元素，li 元素是父元素的第偶数个子元素。last 表示从后数。

  ```css
  li:nth-child(even) {
    color: red;
  }
  ```

- :first-child 以及 :last-child  
  p:first-child 选择 p 元素，p 元素是其父元素的第一个子元素。last 表示最后一个子元素。

  ```css
  p:first-child {
    color: lime;
  }
  ```

- :only-child  
  选择 p 元素，p 元素是其父元素的唯一子元素

  ```css
  p:only-child {
    background-color: lime;
  }
  ```

##### 链接与行为伪类关系选择器

- :any-link 表示任意的链接，包括 a、area 和 link 标签都可能匹配到这个伪类
- :link 表示未访问过的链接， :visited 表示已经访问过的链接
- :hover 表示鼠标悬停在上的元素
- :active 表示用户正在激活这个元素，如用户按下按钮，鼠标还未抬起时，这个按钮就处于激活状态
- :focus 表示焦点落在这个元素之上
- :target 用于选中浏览器 URL 的 hash 部分所指示的元素

##### 逻辑伪类选择器

主要是:not 伪类，表示对括号内的条件取非。

```css
*|*:not(:hover) {
  color: red;
}
```

上面表示，`*|*`表示所有命名空间下的所有元素，当不是处于:hover 状态下时，都被选中，文字都是红色。

### 选择器的组合

上面已经介绍了简单选择器，通过对简单选择器的组合，可以组合成选择器列表和复合选择器以及复杂选择器。当组合后的选择器再一次组合，会有组合的优先级。

- 选择器列表(第一优先级)  
  用连接符号“逗号”分隔，表示逻辑关系“或”，当很多选择器中的声明区块内容相同时使用，减少冗余代码。如下表示 h1 或 h2 或 h3 的颜色是红色。

  ```css
  h1,
  h2,
  h3 {
    color: red;
  }
  ```

- 复合选择器(第二优先级)  
  无连接符号，是连写的选择器，表示逻辑关系“且”。如下表示选中的元素，既要符合元素类型是 div，又要符合 id 是 main。

  ```css
  div#main {
    color: red;
  }
  ```

- 复杂选择器(第三优先级)  
  复杂选择器是针对节点关系的选择。
  - **空格**：后代，表示选中所有符合条件的后代节点， 例如“ .a .b ”表示选中所有具有 class 为 a 的后代节点中 class 为 b 的节点。
  - **>** : 子代，表示选中符合条件的子节点，例如“ .a>.b ”表示：选中所有“具有 class 为 a 的子节点中，class 为 b 的节点”。
  - **+**: 后继，表示选中所有符合条件的后继节点，后继节点即跟当前节点具有同一个父元素，并出现在它之后的节点，例如“ .a~.b ”表示选中所有具有 class 为 a 的后继中，class 为 b 的节点。
  - **~**: 直接后继，表示选中符合条件的直接后继节点，直接后继节点即 nextSlibling。例如 “.a+.b ”表示选中所有具有 class 为 a 的下一个 class 为 b 的节点。
  - **||**: 列选择器，表示选中对应列中符合条件的单元格。

### 选择器的优先级

当多个选择器选中同一个元素后，应用的 CSS 规则有优先级。CSS 标准用一个三元组 (a, b, c) 来构成一个选择器的优先级。

- id 选择器的数目记为 a；
- 伪类选择器和 class 选择器的数目记为 b；
- 伪元素选择器和标签选择器数目记为 c；
- “\*” 不影响优先级。

计算优先级的公式是：`specificity = base * base * a + base * b + c`,base 是一个足够大的正整数。数字大的优先级高。

另外，行内样式的优先级高于 CSS 规则。`!important`是最优先的样式，需要谨慎使用。

实际应用时，不用去记忆这些优先级，只要遵循“根据 id 选单个元素” “class 和 class 的组合选成组元素” “tag 选择器确定页面风格”这样的简单原则来使用选择器，不要搞出过于复杂的选择器。” 这些原则来就行。碰到是在复杂的，打开浏览器调试下也方便。

### 伪元素

严格来说，伪元素不单单是一种选择规则，还是一种机制。它会把实际不存在的元素硬选出来。

- ::first-line: 表示元素的第一行
- ::first-letter: 表示元素的第一个字母
- ::before: 表示在元素之前插入一个虚拟元素
- ::after: 表示在元素之后插入一个虚拟元素

```css
p::first-line {
  text-transform: uppercase;
}
p::first-letter {
  text-transform: uppercase;
  font-size: 2em;
  float: left;
}
p.special::before {
  display: block;
  content: "pseudo! ";
}
```

## 声明区块

声明区块由`属性: 值`组成。具体说明可参考 mdn。

### 计算型函数

一些属性会要求产生函数类型的值。
CSS 的常用计算型函数如下：

- `calc()`
- `max()`
- `min()`
- `clamp()`
- `toggle()`
- `attr()`
